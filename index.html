<html>
	<head>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-1.11.3.js"></script>
    <script src="https://code.jquery.com/jquery-migrate-1.4.1.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <script type="text/javascript" src="jquery.ba-bbq.min.js"></script>
	</head>
	<body>
    <div class="container">
      <h1>Permutator</h1>

      <div class="row" style="margin-bottom: 25px">
        <div class="col-md-3">
	        <input type="text" class="form-control" id="intentName" placeholder="intent">
        </div>
        <div class="col-md-3">
	        <textarea class="form-control" id="verbs" placeholder="something" rows="5"></textarea>
        </div>
        <div class="col-md-3">
	        <textarea class="form-control" id="connectors" placeholder="something" rows="5"></textarea>
        </div>
        <div class="col-md-3">
  		    <textarea class="form-control" id="nouns" placeholder="something" rows="5"></textarea>
        </div>
      </div>

      <button class="btn btn-default" style="margin-bottom: 10px" id="copy">Copy</button>

      <pre><code id="output">
        This is a tool that helps you permutate text together for Alexa intents.  Just start typing in the boxes above, you'll figure it out...
      </code></pre>

      <script>
        var params = $.deparam.querystring();
        if(params.intentName) $("#intentName").val(params.intentName);
        if(params.nouns) $("#nouns").val(params.nouns.join('\n'));
        if(params.connectors) $("#connectors").val(params.connectors.join('\n'));
        if(params.verbs) $("#verbs").val(params.verbs.join('\n'));

        $("#copy").click(function() {
          console.log("here");
          var $temp = $("<textarea>");
          $("body").append($temp);
          $temp.val($("#output").text()).select();
          document.execCommand("copy");
          $temp.remove();
        });

        $(".form-control").on('change keyup paste click', function() {
          var utterances = '';

          var intentName = $("#intentName").val();
          var verbs = $("#verbs").val().split('\n');
          var connectors = $("#connectors").val().split('\n');
          var nouns = $("#nouns").val().split('\n');
          if(intentName.trim().length > 0) {
            verbs.forEach(function(verb) {
              connectors.forEach(function(connector) {
                nouns.forEach(function(noun) {
                  if((verb.trim().length == 0) &&
                     (connector.trim().length == 0) &&
                     (noun.trim().length == 0)) {
                    // do nothing
                  } else if((noun.trim().length == 0) && 
                            (connector.trim().length == 0)) {
                    utterances += intentName + " " + verb + "\n";
                  } else if((verb.trim().length == 0) && 
                            (connector.trim().length == 0)) {
                    utterances += intentName + " " + noun + "\n";
                  } else if((verb.trim().length == 0) && 
                            (noun.trim().length == 0)) {
                    utterances += intentName + " " + connector + "\n";
                  } else if((verb.trim().length == 0)) {
                    utterances += intentName + " " + connector + " " + noun + "\n";
                  } else if((connector.trim().length == 0)) {
                    utterances += intentName + " " + verb + " " + noun + "\n";
                  } else if((noun.trim().length == 0)) {
                    utterances += intentName + " " + verb + " " + connector + "\n";
                  } else {
                    utterances += intentName + " " + verb + " " + connector + " " + noun + "\n";
                  }
                });
              });
            });
          }

          var json = {};
          json.intentName = intentName;
          json.verbs = verbs;
          json.connectors = connectors;
          json.nouns = nouns;

          var header = '';
          // header += "# permutator json = " + JSON.stringify(json) + "\n";
          var loc = window.location;
          var baseUrl = loc.protocol + "//" + loc.hostname + (loc.port? ":"+loc.port : "") + loc.pathname;
          header += "# permutator link = " + baseUrl + "?" + $.param(json) + "\n";

          $("#output").text(header + utterances);
        }).click();
      </script>
	</body>
</html>